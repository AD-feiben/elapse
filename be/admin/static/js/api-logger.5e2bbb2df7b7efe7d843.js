webpackJsonp([14],{Gdcn:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=a("lC5x"),o=a.n(i),s=a("J0Oq"),r=a.n(s),c=a("Yarq"),l=a.n(c),u=a("AA3o"),g=a.n(u),d=a("xSur"),h=a.n(d),p=a("UzKs"),f=a.n(p),v=a("Y7Ml"),_=a.n(v),y=a("VCXJ"),k=a("9ZwC"),w=a.n(k),b=a("6wm7"),m=a("jagD"),S=w()({watch:{page:function(){this.fetchApiErrorLog()},pageSize:function(){this.fetchApiErrorLog()}}})(n=function(e){function t(){var e,a,n,i;g()(this,t);for(var o=arguments.length,s=Array(o),r=0;r<o;r++)s[r]=arguments[r];return a=n=f()(this,(e=t.__proto__||l()(t)).call.apply(e,[this].concat(s))),n.logs=[],n.selectedLog="",n.tableHead=["请求地址","Http动作","响应码","邮件通知","日期","操作"],n.tableKeys=["requestUrl","method","statusCode","isSendMail","dateTime"],n.total=0,n.keyword="",n.page=1,n.pageSize=20,n.showDialog=!1,i=a,f()(n,i)}return _()(t,e),h()(t,[{key:"created",value:function(){this.fetchApiErrorLog()}},{key:"fetchApiErrorLog",value:function(){var e=r()(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.$loading.start(),e.prev=1,e.next=4,m.a.getApiErrorLog({page:this.page,pageSize:this.pageSize,keyword:this.keyword});case 4:t=e.sent,this.logs=t.items.map(function(e){return delete e._id,delete e.__v,delete e.responseTime,e.dateTime=Object(b.a)(e.dateTime),e.isSendMail=e.isSendMail?"已发送":"未发送",e}),this.total=t.total,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),this.$message.error(e.t0.message);case 12:return e.prev=12,this.$loading.close(),e.finish(12);case 15:case"end":return e.stop()}},e,this,[[1,9,12,15]])}));return function(){return e.apply(this,arguments)}}()},{key:"checkLog",value:function(e){this.selectedLog=e,this.showDialog=!0}},{key:"search",value:function(){this.page=1,this.fetchApiErrorLog()}},{key:"handlePageChange",value:function(e){this.page=e}},{key:"handlePageSizeChange",value:function(e){this.pageSize=e}}]),t}(y.default))||n,C={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ta-page"},[a("div",{staticClass:"ta-page__search"},[a("ta-input",{attrs:{placeholder:"请输入关键词（url, method），回车以搜索"},on:{focus:function(t){e.isFocus=!0},blur:function(t){e.isFocus=!1},enter:function(t){e.search()}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),e._v(" "),a("div",{staticClass:"ta-page__content"},[a("ta-table",{attrs:{tableHead:e.tableHead,tableBody:e.logs,needIndex:!0,index:e.pageSize*(e.page-1),keys:e.tableKeys}},e._l(e.logs,function(t,n){return a("div",{key:n,attrs:{slot:n},slot:n},[a("ta-button",{attrs:{size:"small"},on:{click:function(a){e.checkLog(t)}}},[e._v("详情")])],1)}))],1),e._v(" "),a("ta-pagination",{attrs:{total:e.total,page:e.page},on:{pageChange:function(t){e.handlePageChange(t)},pageSizeChange:function(t){e.handlePageSizeChange(t)}}}),e._v(" "),e.showDialog?a("ta-dialog",{attrs:{title:"错误详情",showFooter:!1},on:{cancel:function(t){e.showDialog=!1}}},[a("table",[a("tbody",e._l(Object.keys(e.selectedLog),function(t,n){return a("tr",{key:n},[a("td",{attrs:{width:"100"}},[e._v(e._s(t))]),e._v(" "),a("td",[e._v(e._s(e.selectedLog[t]))])])}))])]):e._e()],1)},staticRenderFns:[]};var L=a("Z0/y")(S,C,!1,function(e){a("N5Sp")},"data-v-2c205a48",null);t.default=L.exports},N5Sp:function(e,t){}});
//# sourceMappingURL=api-logger.5e2bbb2df7b7efe7d843.js.map